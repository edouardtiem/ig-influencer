name: Elena Vacation Reel

on:
  schedule:
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # REELS ELENA â€” 4x/semaine (Mer, Jeu, Sam, Dim)
    # 21h Paris = 20h UTC (winter) / 19h UTC (summer)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    # Mercredi (day 3) â€” Reach
    - cron: '0 20 * * 3'
    
    # Jeudi (day 4) â€” Reach
    - cron: '0 20 * * 4'
    
    # Samedi (day 6) â€” BEST DAY ğŸ”¥ +60%
    - cron: '0 20 * * 6'
    
    # Dimanche (day 0) â€” BEST DAY ğŸ”¥ +55%
    - cron: '0 20 * * 0'
  
  workflow_dispatch:
    inputs:
      theme:
        description: 'Vacation theme (spa, city, yacht, auto)'
        required: false
        default: 'auto'
        type: choice
        options:
          - auto
          - spa
          - city
          - yacht
      test_mode:
        description: 'Test mode (no publish)'
        required: false
        default: 'false'
        type: boolean

jobs:
  vacation-reel-elena:
    runs-on: ubuntu-latest
    timeout-minutes: 15
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install FFmpeg
        run: |
          sudo apt-get update
          sudo apt-get install -y ffmpeg

      - name: Install dependencies
        working-directory: ./app
        run: npm install replicate

      - name: Generate and Post Elena Vacation Reel
        working-directory: ./app
        env:
          REPLICATE_API_TOKEN: ${{ secrets.REPLICATE_API_TOKEN }}
          CLOUDINARY_CLOUD_NAME: ${{ secrets.CLOUDINARY_CLOUD_NAME }}
          CLOUDINARY_API_KEY: ${{ secrets.CLOUDINARY_API_KEY }}
          CLOUDINARY_API_SECRET: ${{ secrets.CLOUDINARY_API_SECRET }}
          INSTAGRAM_ACCESS_TOKEN_ELENA: ${{ secrets.INSTAGRAM_ACCESS_TOKEN_ELENA }}
          INSTAGRAM_ACCOUNT_ID_ELENA: ${{ secrets.INSTAGRAM_ACCOUNT_ID_ELENA }}
        run: |
          THEME="${{ github.event.inputs.theme || 'auto' }}"
          TEST="${{ github.event.inputs.test_mode }}"
          DAY=$(date -u +%u)
          DAY_NAME=$(date -u +%A)
          
          echo "ğŸŒŸ Starting Elena vacation reel generation"
          echo "ğŸ“… Day: $DAY_NAME"
          echo "ğŸ–ï¸ Theme: $THEME"
          echo "ğŸ§ª Test mode: $TEST"
          
          # Log engagement info
          if [ "$DAY" -eq 6 ] || [ "$DAY" -eq 0 ]; then
            echo "ğŸ”¥ Weekend = Best reel engagement (+55-60%)"
          fi
          
          node scripts/vacation-reel-post-elena.mjs "$THEME" "$TEST"

